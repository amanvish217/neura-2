import { useState } from "react";
import { Card, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";

const questions = [
  {
    q: "What is Neura?",
    options: [
      "A layer-2 rollup on Ethereum",
      "A sovereign, EVM-compatible Layer 1 blockchain for real-time finance and stablecoins",
      "A decentralized exchange protocol",
      "A privacy coin",
    ],
    answer: 1,
  },
  {
    q: "Which stablecoin is native to Neura and used for gasless transfers?",
    options: ["USDT", "USDC", "$USN", "DAI"],
    answer: 2,
  },
  {
    q: "Which consensus mechanism does Neura use to achieve deterministic finality and avoid forks?",
    options: ["Proof of Work", "Tendermint", "QBFT", "Delegated Proof of Stake"],
    answer: 2,
  },
  {
    q: "Which of the following is not a key differentiator claimed by Neura?",
    options: [
      "Gasless stablecoin transfers",
      "Sovereign infrastructure (owning physical hardware)",
      "Privacy by default (zero-knowledge encryption for all txns)",
      "Sustainable revenues via RPCfi, MEV, OEV",
    ],
    answer: 2,
  },
  {
    q: "What does RPCfi refer to in Neuraâ€™s design?",
    options: [
      "A caching layer for RPC calls",
      "A revenue primitive that monetizes RPC infrastructure usage",
      "A bridge protocol",
      "A token swap mechanism",
    ],
    answer: 1,
  },
  {
    q: "Which token(s) can be used as whitelisted gas assets in Neura (besides $USN)?",
    options: ["Only $ETH", "Only $ANKR", "$ANKR and others", "No other token allowed"],
    answer: 2,
  },
  {
    q: "What layer(s) does Neura claim to control (sovereign) in its infrastructure stack?",
    options: [
      "Only the protocol (software) layer",
      "Only the validator / consensus layer",
      "Physical hardware, network / fiber, and protocol layers",
      "Only cloud / virtual infrastructure",
    ],
    answer: 2,
  },
  {
    q: "Which design goal ensures that Neura transactions settle instantly and predictably?",
    options: ["High gas fees", "Eventual consistency", "Sub-second block times and instant finality", "Sharding"],
    answer: 2,
  },
  {
    q: "How does Neura intend to support cross-chain interoperability?",
    options: [
      "It doesnâ€™t support cross-chain transfers",
      "Through its own built-in sharding protocol",
      "Using canonical bridge contracts and validators to verify cross-chain messages",
      "Via centralized custodians",
    ],
    answer: 2,
  },
  {
    q: "Which of the following is not a revenue source mentioned in Neuraâ€™s tokenomics model?",
    options: ["RPCfi usage revenues", "MEV capture", "Inflationary token emissions", "Reserve yield recycling"],
    answer: 2,
  },
];

export default function GsentiQuiz() {
  const [name, setName] = useState("");
  const [started, setStarted] = useState(false);
  const [current, setCurrent] = useState(0);
  const [score, setScore] = useState(0);
  const [finished, setFinished] = useState(false);

  const handleAnswer = (i) => {
    if (i === questions[current].answer) {
      setScore(score + 1);
    }
    if (current + 1 < questions.length) {
      setCurrent(current + 1);
    } else {
      setFinished(true);
    }
  };

  const handleShare = () => {
    const text = `I just scored ${score}/${questions.length} in the Gsenti Quiz! ðŸš€`; 
    const url = "https://www.gsenti.xyz/";
    window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`, "_blank");
  };

  return (
    <div
      className="min-h-screen bg-cover bg-center flex flex-col items-center justify-center p-6"
      style={{ backgroundImage: "url('/background.jpg')" }}
    >
      {!started ? (
        <div className="bg-white/80 p-6 rounded-2xl shadow-lg text-center">
          <img src="/logo.png" alt="Gsenti Logo" className="mx-auto mb-4 animate-bounce w-16 h-16" />
          <h1 className="text-2xl font-bold mb-4">Welcome to Gsenti Protocol Quiz</h1>
          <input
            type="text"
            placeholder="Enter your name"
            className="border p-2 rounded w-full mb-4"
            value={name}
            onChange={(e) => setName(e.target.value)}
          />
          <Button disabled={!name} onClick={() => setStarted(true)}>
            Start Quiz
          </Button>
        </div>
      ) : (
        <Card className="max-w-xl w-full p-6 shadow-lg rounded-2xl bg-white/90">
          <CardContent>
            {!finished ? (
              <div>
                <h2 className="text-lg font-semibold mb-4">{questions[current].q}</h2>
                <div className="grid gap-3">
                  {questions[current].options.map((opt, i) => (
                    <Button
                      key={i}
                      variant="outline"
                      className="justify-start text-left"
                      onClick={() => handleAnswer(i)}
                    >
                      {opt}
                    </Button>
                  ))}
                </div>
                <p className="mt-4 text-sm text-gray-500">
                  Question {current + 1} of {questions.length}
                </p>
              </div>
            ) : (
              <div className="text-center">
                <h2 className="text-xl font-bold mb-4">Quiz Finished!</h2>
                <p className="text-lg">{name}, your Score: {score} / {questions.length}</p>
                <Button className="mt-4 mr-2" onClick={() => { setCurrent(0); setScore(0); setFinished(false); }}>Restart Quiz</Button>
                <Button className="mt-4" onClick={handleShare}>Share on Twitter</Button>
              </div>
            )}
          </CardContent>
        </Card>
      )}
    </div>
  );
}
